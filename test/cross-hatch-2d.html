<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>2D クロスハッチ効果</title><style>body{font-family:Arial,sans-serif;margin:0;padding:20px;background-color:#f0f0f0}#controls{max-width:800px;margin:0 auto}#canvasContainer{display:flex;justify-content:space-between;max-width:800px;margin:20px auto}#canvasContainer div{text-align:center}canvas{border:1px solid #ccc;background-color:#fff}#sliderContainer{max-width:800px;margin:20px auto}.slider-group{margin-bottom:10px}input[type=range]{width:100%}#imageInput{margin-bottom:20px}</style></head><body><div id="controls"><input type="file" id="imageInput" accept="image/*"><div id="canvasContainer"><div><h3>オリジナル</h3><canvas id="originalCanvas" width="400" height="400"></canvas></div><div><h3>クロスハッチ効果</h3><canvas id="effectCanvas" width="400" height="400"></canvas></div></div><div id="sliderContainer"><div class="slider-group">線の頻度: <span id="lineFrequencyValue">0.7</span> <input type="range" id="lineFrequency" min="0.1" max="2" step="0.1" value="0.7"></div><div class="slider-group">線の太さ: <span id="lineThicknessValue">0.5</span> <input type="range" id="lineThickness" min="0.1" max="2" step="0.1" value="0.5"></div><div class="slider-group">コントラスト: <span id="contrastValue">1</span> <input type="range" id="contrast" min="0" max="2" step="0.1" value="1"></div><div class="slider-group">明るさ: <span id="brightnessValue">0.2</span> <input type="range" id="brightness" min="-1" max="1" step="0.1" value="0.2"></div></div></div><script>const originalCanvas=document.getElementById("originalCanvas"),effectCanvas=document.getElementById("effectCanvas"),originalCtx=originalCanvas.getContext("2d"),effectCtx=effectCanvas.getContext("2d"),imageInput=document.getElementById("imageInput"),lineFrequencySlider=document.getElementById("lineFrequency"),lineThicknessSlider=document.getElementById("lineThickness"),contrastSlider=document.getElementById("contrast"),brightnessSlider=document.getElementById("brightness"),lineFrequencyValue=document.getElementById("lineFrequencyValue"),lineThicknessValue=document.getElementById("lineThicknessValue"),contrastValue=document.getElementById("contrastValue"),brightnessValue=document.getElementById("brightnessValue");let image=new Image;function applyEffect(){const e=originalCtx.getImageData(0,0,400,400),t=e.data,n=parseFloat(lineFrequencySlider.value),a=parseFloat(lineThicknessSlider.value),l=parseFloat(contrastSlider.value),i=parseFloat(brightnessSlider.value);for(let e=0;e<400;e++)for(let s=0;s<400;s++){const r=4*(400*e+s),d=(.299*t[r]+.587*t[r+1]+.114*t[r+2])/255,c=Math.pow(d,l)+i;let u=255;c<.2&&Math.sin(s*n)*Math.sin(e*n)<a&&(u=0),c<.5&&Math.sin((s+e)*n)*Math.sin((s-e)*n)<a&&(u=0),c<.8&&Math.sin(e*n*2)*Math.sin(s*n*2)<a&&(u=0),t[r]=t[r+1]=t[r+2]=u}effectCtx.putImageData(e,0,0)}imageInput.addEventListener("change",(e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.onload=e=>{image.src=e.target.result,image.onload=()=>{originalCtx.drawImage(image,0,0,400,400),applyEffect()}},e.readAsDataURL(t)}})),lineFrequencySlider.addEventListener("input",(e=>{lineFrequencyValue.textContent=e.target.value,applyEffect()})),lineThicknessSlider.addEventListener("input",(e=>{lineThicknessValue.textContent=e.target.value,applyEffect()})),contrastSlider.addEventListener("input",(e=>{contrastValue.textContent=e.target.value,applyEffect()})),brightnessSlider.addEventListener("input",(e=>{brightnessValue.textContent=e.target.value,applyEffect()}))</script></body></html>