<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>修正版自動スピードライン生成ツール</title><script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script><style>body{font-family:sans-serif;text-align:center}canvas{border:1px solid #000}#controls,#options{margin:10px 0}.option-group{display:inline-block;margin:0 10px}</style></head><body><h1>修正版自動スピードライン生成ツール</h1><div id="controls"><button id="horizontal">水平線</button> <button id="vertical">垂直線</button> <button id="diagonal">斜め線</button> <button id="cross">十字線</button> <button id="clear">クリア</button></div><div id="options"><div class="option-group"><label for="density">密度: <span id="densityValue">50</span></label> <input type="range" id="density" min="1" max="200" value="50"></div><div class="option-group"><label for="angle">角度: <span id="angleValue">0</span>°</label> <input type="range" id="angle" min="0" max="359" value="0"></div><div class="option-group"><label for="gradientStart">グラデーション開始: <span id="gradientStartValue">0</span>%</label> <input type="range" id="gradientStart" min="0" max="100" value="0"></div><div class="option-group"><label for="gradientEnd">グラデーション終了: <span id="gradientEndValue">100</span>%</label> <input type="range" id="gradientEnd" min="0" max="100" value="100"></div><div class="option-group"><label for="lineColor">線の色:</label> <input type="color" id="lineColor" value="#000000"></div><div class="option-group"><label for="gradientToggle">グラデーション:</label> <input type="checkbox" id="gradientToggle" checked="checked"></div></div><canvas id="canvas" width="600" height="400"></canvas><script>const canvas=new fabric.Canvas("canvas");function updateValue(e){const t=document.getElementById(e);document.getElementById(e+"Value").textContent=t.value}function drawLine(e,t,a){const n=document.getElementById("gradientToggle").checked,c=document.getElementById("lineColor").value,o=parseInt(document.getElementById("gradientStart").value)/100,d=parseInt(document.getElementById("gradientEnd").value)/100;let r;if(n){const n=new fabric.Gradient({type:"linear",coords:{x1:e.x,y1:e.y,x2:t.x,y2:t.y},colorStops:[{offset:0,color:c,opacity:o},{offset:1,color:c,opacity:d}]});r=new fabric.Line([e.x,e.y,t.x,t.y],{stroke:n,strokeWidth:a.strokeWidth||1})}else r=new fabric.Line([e.x,e.y,t.x,t.y],{stroke:c,strokeWidth:a.strokeWidth||1,opacity:a.opacity||1});canvas.add(r)}function drawSpeedlines(e){canvas.clear();const t=parseInt(document.getElementById("density").value),a=parseInt(document.getElementById("angle").value)*Math.PI/180,n=canvas.width,c=canvas.height;for(let o=0;o<t;o++){let d,r;switch(e){case"horizontal":d={x:0,y:o*c/t},r={x:n,y:o*c/t};break;case"vertical":d={x:o*n/t,y:0},r={x:o*n/t,y:c};break;case"diagonal":d={x:0,y:o*(c+n)/t},r={x:o*(c+n)/t,y:0};break;case"cross":o<t/2?(d={x:0,y:o*c/(t/2)},r={x:n,y:o*c/(t/2)}):(d={x:(o-t/2)*n/(t/2),y:0},r={x:(o-t/2)*n/(t/2),y:c})}const i=r.x-d.x,s=r.y-d.y;drawLine(d,{x:d.x+i*Math.cos(a)-s*Math.sin(a),y:d.y+i*Math.sin(a)+s*Math.cos(a)},{opacity:1,strokeWidth:1})}canvas.renderAll()}["density","angle","gradientStart","gradientEnd"].forEach((e=>{document.getElementById(e).addEventListener("input",(()=>updateValue(e)))})),document.querySelectorAll("button").forEach((e=>{e.addEventListener("click",(()=>{"clear"===e.id?canvas.clear():drawSpeedlines(e.id)}))}))</script></body></html>