<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Floating Panels</title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <style>
        .floating-panel {
            position: fixed;
            width: 90%;
            max-width: 250px;
            background-color: white;
            border: 1px solid #ddd;
            padding: 10px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            border-radius: 5px;
            font-size: 0.9rem;
        }
        .ui-widget-content {
            border: 1px solid #ddd;
        }
        .control-item {
            margin-bottom: 5px;
        }
        .control-row {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }
        .control-row label {
            flex: 0 0 60px;
            margin: 0;
        }
        .control-row input[type="range"] {
            flex: 1;
        }
        .control-row span {
            flex: 0 0 40px;
            text-align: right;
            margin-left: 5px;
        }
        .panel-header {
            font-size: 1rem;
            font-weight: bold;
            margin-bottom: 5px;
            text-align: center;
            cursor: pointer;
        }
        .separator {
            margin: 5px 0;
        }
        .radio-options {
            display: flex;
            justify-content: space-between;
        }
        .radio-options label {
            margin-right: 5px;
        }
        .collapse-icon {
            margin-left: 5px;
            transition: transform 0.3s;
        }
        .collapsed .collapse-icon {
            transform: rotate(180deg);
        }
    </style>
</head>
<body>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<script>
    $(function() {
        const createPanel = (id, title, content, top) => {
            const panel = $(`
                <div id="${id}" class="floating-panel" style="top: ${top}px; right: 10px;">
                    <div class="panel-header" data-toggle="collapse" data-target="#${id}Content" aria-expanded="true" aria-controls="${id}Content">
                        ${title}
                        <span class="collapse-icon">&#x25BC;</span>
                    </div>
                    <div id="${id}Content" class="collapse show">
                        ${content}
                    </div>
                </div>
            `);
            $('body').append(panel);
            panel.draggable();
            panel.find('.panel-header').click(function() {
                $(this).find('.collapse-icon').toggleClass('collapsed');
            });
        };

        const imageControlContent = `
            <div class="control-item">
                <label><input type="checkbox" id="sepiaEffect"> Sepia</label>
            </div>
            <hr class="separator">
            <div class="control-item">
                <label><input type="checkbox" id="grayscaleEffect"> Grayscale</label>
            </div>
            <div class="control-item radio-options" id="grayscaleOptions">
                <label><input type="radio" name="grayscaleMode" value="average" checked> Average</label>
                <label><input type="radio" name="grayscaleMode" value="luminosity"> Luminosity</label>
            </div>
            <hr class="separator">
            <div class="control-row">
                <label>Red</label>
                <input type="range" id="gammaRed" min="0" max="2.2" step="0.003921" value="1">
                <span id="gammaRedValue">1.0</span>
            </div>
            <div class="control-row">
                <label>Green</label>
                <input type="range" id="gammaGreen" min="0" max="2.2" step="0.003921" value="1">
                <span id="gammaGreenValue">1.0</span>
            </div>
            <div class="control-row">
                <label>Blue</label>
                <input type="range" id="gammaBlue" min="0" max="2.2" step="0.003921" value="1">
                <span id="gammaBlueValue">1.0</span>
            </div>
            <hr class="separator">
            <div class="control-row">
                <label>Vibrance</label>
                <input type="range" id="vibranceValue" min="-1" max="1" step="0.003921" value="0">
                <span id="vibranceValueDisplay">0.0</span>
            </div>
            <div class="control-row">
                <label>Blur</label>
                <input type="range" id="blurValue" min="0" max="0.3" step="0.003921" value="0">
                <span id="blurValueDisplay">0.0</span>
            </div>
            <div class="control-row">
                <label>Pixelate</label>
                <input type="range" id="pixelateValue" min="1" max="20" step="1" value="1">
                <span id="pixelateValueDisplay">1</span>
            </div>
        `;

        const commonControlsContent = `
            <div class="control-row">
                <label>Angle</label>
                <input type="range" id="angle-control" min="0" max="360" value="0">
            </div>
            <div class="control-row">
                <label>Scale</label>
                <input type="range" id="scale-control" min="0.01" max="2.5" step="0.01" value="1">
            </div>
            <div class="control-row">
                <label>Top</label>
                <input type="range" id="top-control" min="-1200" max="1200" value="100">
            </div>
            <div class="control-row">
                <label>Left</label>
                <input type="range" id="left-control" min="-1200" max="1200" value="100">
            </div>
            <div class="control-row">
                <label>SkewX</label>
                <input type="range" id="skewX-control" min="-30" max="30" value="0">
            </div>
            <div class="control-row">
                <label>SkewY</label>
                <input type="range" id="skewY-control" min="-30" max="30" value="0">
            </div>
        `;

        createPanel('commonControlsPanel', 'Common Controls', commonControlsContent, 10);
        createPanel('imageControlPanel', 'Image Control', imageControlContent, 300);

        function updateSliderValue(sliderId, displayId) {
            $(sliderId).on("input change", function() {
                $(displayId).text(parseFloat($(this).val()).toFixed(2));
            });
        }

        updateSliderValue("#gammaRed", "#gammaRedValue");
        updateSliderValue("#gammaGreen", "#gammaGreenValue");
        updateSliderValue("#gammaBlue", "#gammaBlueValue");
        updateSliderValue("#vibranceValue", "#vibranceValueDisplay");
        updateSliderValue("#blurValue", "#blurValueDisplay");
        updateSliderValue("#pixelateValue", "#pixelateValueDisplay");

        $("#gammaRedValue").text(parseFloat($("#gammaRed").val()).toFixed(2));
        $("#gammaGreenValue").text(parseFloat($("#gammaGreen").val()).toFixed(2));
        $("#gammaBlueValue").text(parseFloat($("#gammaBlue").val()).toFixed(2));
        $("#vibranceValueDisplay").text(parseFloat($("#vibranceValue").val()).toFixed(2));
        $("#blurValueDisplay").text(parseFloat($("#blurValue").val()).toFixed(2));
        $("#pixelateValueDisplay").text(parseFloat($("#pixelateValue").val()).toFixed(0));

        updateSliderValue("#angle-control", "#angle-control");
        updateSliderValue("#scale-control", "#scale-control");
        updateSliderValue("#top-control", "#top-control");
        updateSliderValue("#left-control", "#left-control");
        updateSliderValue("#skewX-control", "#skewX-control");
        updateSliderValue("#skewY-control", "#skewY-control");
    });
</script>

</body>
</html>
