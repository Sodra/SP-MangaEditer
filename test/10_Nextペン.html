<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Fabric.js Drawing Tool</title><script src="fabric.min_PlusEraser.js"></script><style>canvas{border:1px solid #ccc}.toolbox{margin-bottom:10px}.toolbox button,.toolbox input,.toolbox select{margin-right:5px}.toolbox label{margin-right:5px}</style></head><body><div class="toolbox"><button id="draw">ペンツール</button> <button id="eraser">消しゴム</button> <button id="clear">クリア</button> <button id="add-image">画像追加</button> <input type="file" id="image-input" accept="image/*" style="display:none"> <label for="brush-width">ペンの太さ:</label> <input type="range" id="brush-width" min="1" max="50" value="5"> <span id="brush-width-value">5</span> <label for="brush-color">ペンの色:</label> <input type="color" id="brush-color" value="#000000"> <label for="brush-type">ペンの種類:</label> <select id="brush-type"><option value="Pencil">鉛筆</option><option value="Circle">円形</option><option value="Spray">スプレー</option></select> <label for="brush-opacity">透明度:</label> <input type="range" id="brush-opacity" min="0" max="1" step="0.1" value="1"> <span id="brush-opacity-value">1.0</span> <label for="line-style">線のスタイル:</label> <select id="line-style"><option value="solid">実線</option><option value="dashed">破線</option><option value="dotted">点線</option></select> <label for="bg-color">背景色:</label> <input type="color" id="bg-color" value="#ffffff"></div><canvas id="c" width="800" height="600"></canvas><script>const canvas=new fabric.Canvas("c");let isDrawingMode=!1;function applyBrushSettings(){if(!canvas.freeDrawingBrush)return;const e=parseInt(document.getElementById("brush-width").value,10)||1;canvas.freeDrawingBrush.width=e,void 0!==canvas.freeDrawingBrush.color&&(canvas.freeDrawingBrush.color=document.getElementById("brush-color").value),void 0!==canvas.freeDrawingBrush.opacity&&(canvas.freeDrawingBrush.opacity=parseFloat(document.getElementById("brush-opacity").value));const n=document.getElementById("line-style").value;"solid"===n?canvas.freeDrawingBrush.strokeDashArray=null:"dashed"===n?canvas.freeDrawingBrush.strokeDashArray=[4*e,4*e]:"dotted"===n&&(canvas.freeDrawingBrush.strokeDashArray=[e,4*e]),console.log("Brush settings applied: width =",e,"color =",canvas.freeDrawingBrush.color,"opacity =",canvas.freeDrawingBrush.opacity,"line style =",n)}document.getElementById("draw").onclick=function(){isDrawingMode=!0,canvas.isDrawingMode=!0,canvas.freeDrawingBrush=new fabric.PencilBrush(canvas),applyBrushSettings(),console.log("Drawing mode enabled:",isDrawingMode)},document.getElementById("eraser").onclick=function(){isDrawingMode=!0,canvas.isDrawingMode=!0;const e=new fabric.EraserBrush(canvas);e.width=parseInt(document.getElementById("brush-width").value,10)||10,canvas.freeDrawingBrush=e,applyBrushSettings(),console.log("Eraser mode enabled:",isDrawingMode)},document.getElementById("clear").onclick=function(){canvas.clear(),console.log("Canvas cleared")},document.getElementById("add-image").onclick=function(){document.getElementById("image-input").click()},document.getElementById("image-input").onchange=function(e){const n=new FileReader;n.onload=function(e){const n=new Image;n.src=e.target.result,n.onload=function(){const e=new fabric.Image(n),a=Math.min(canvas.width/e.width,canvas.height/e.height);e.scale(a),canvas.add(e),console.log("Image added")}},n.readAsDataURL(e.target.files[0])},document.getElementById("brush-width").oninput=function(){document.getElementById("brush-width-value").innerText=this.value,applyBrushSettings(),console.log("Brush width changed:",this.value)},document.getElementById("brush-color").onchange=function(){applyBrushSettings(),console.log("Brush color changed:",this.value)},document.getElementById("brush-opacity").oninput=function(){document.getElementById("brush-opacity-value").innerText=this.value,applyBrushSettings(),console.log("Brush opacity changed:",this.value)},document.getElementById("brush-type").onchange=function(){const e=this.value;"Pencil"===e?canvas.freeDrawingBrush=new fabric.PencilBrush(canvas):"Circle"===e?canvas.freeDrawingBrush=new fabric.CircleBrush(canvas):"Spray"===e&&(canvas.freeDrawingBrush=new fabric.SprayBrush(canvas)),applyBrushSettings(),console.log("Brush type changed:",e)},document.getElementById("line-style").onchange=function(){applyBrushSettings(),console.log("Line style changed:",this.value)},document.getElementById("bg-color").onchange=function(){canvas.backgroundColor=this.value,canvas.renderAll(),console.log("Background color changed:",this.value)},applyBrushSettings()</script></body></html>