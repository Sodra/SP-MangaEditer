<!DOCTYPE html><html lang="ja"><head><meta charset="UTF-8"><title>Fabric.js Animation Example</title><script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.0/fabric.min.js"></script><style>canvas{border:1px solid #000}</style></head><body><canvas id="canvas" width="800" height="600"></canvas><div><button id="rotateButton">回転</button> <button id="moveButton">移動</button> <button id="bounceButton">バウンド</button> <button id="scaleButton">拡大縮小</button> <button id="heartbeatButton">心臓の鼓動</button> <button id="fadeButton">フェード</button> <button id="flipButton">フリップ</button> <button id="shakeButton">震え</button> <button id="startRecordingButton">録画開始</button> <button id="stopRecordingButton">録画停止</button></div><script>const canvas=new fabric.Canvas("canvas");let img,mediaRecorder,recordedChunks=[];function animateRotation(e){!function n(){e.animate("angle",e.angle+360,{onChange:canvas.renderAll.bind(canvas),duration:2e3,easing:fabric.util.ease.easeOutBounce,onComplete:n})}()}function animateMovement(e){!function n(){e.animate("left",e.left+100,{onChange:canvas.renderAll.bind(canvas),duration:1e3,easing:fabric.util.ease.easeInOutQuad,onComplete:()=>e.animate("left",e.left-100,{onChange:canvas.renderAll.bind(canvas),duration:1e3,easing:fabric.util.ease.easeInOutQuad,onComplete:n})})}()}function animateBounce(e){!function n(){e.animate("top",e.top+50,{onChange:canvas.renderAll.bind(canvas),duration:1e3,easing:fabric.util.ease.easeInOutQuad,onComplete:()=>e.animate("top",e.top-50,{onChange:canvas.renderAll.bind(canvas),duration:1e3,easing:fabric.util.ease.easeInOutQuad,onComplete:n})})}()}function animateScale(e){!function n(){e.animate("scaleX",1.5*e.scaleX,{onChange:canvas.renderAll.bind(canvas),duration:1e3,easing:fabric.util.ease.easeInOutQuad,onComplete:()=>e.animate("scaleX",e.scaleX/1.5,{onChange:canvas.renderAll.bind(canvas),duration:1e3,easing:fabric.util.ease.easeInOutQuad,onComplete:n})}),e.animate("scaleY",1.5*e.scaleY,{onChange:canvas.renderAll.bind(canvas),duration:1e3,easing:fabric.util.ease.easeInOutQuad,onComplete:()=>e.animate("scaleY",e.scaleY/1.5,{onChange:canvas.renderAll.bind(canvas),duration:1e3,easing:fabric.util.ease.easeInOutQuad})})}()}function animateHeartbeat(e){!function n(){e.animate("scaleX",1.2*e.scaleX,{onChange:canvas.renderAll.bind(canvas),duration:500,easing:fabric.util.ease.easeInOutQuad,onComplete:()=>e.animate("scaleX",e.scaleX/1.2,{onChange:canvas.renderAll.bind(canvas),duration:500,easing:fabric.util.ease.easeInOutQuad,onComplete:n})}),e.animate("scaleY",1.2*e.scaleY,{onChange:canvas.renderAll.bind(canvas),duration:500,easing:fabric.util.ease.easeInOutQuad,onComplete:()=>e.animate("scaleY",e.scaleY/1.2,{onChange:canvas.renderAll.bind(canvas),duration:500,easing:fabric.util.ease.easeInOutQuad})})}()}function animateFade(e){!function n(){e.animate("opacity",0,{onChange:canvas.renderAll.bind(canvas),duration:1e3,easing:fabric.util.ease.easeInOutQuad,onComplete:()=>e.animate("opacity",1,{onChange:canvas.renderAll.bind(canvas),duration:1e3,easing:fabric.util.ease.easeInOutQuad,onComplete:n})})}()}function animateFlip(e){!function n(){e.animate("flipX",!e.flipX,{onChange:canvas.renderAll.bind(canvas),duration:1e3,easing:fabric.util.ease.easeInOutQuad,onComplete:()=>e.animate("flipX",!e.flipX,{onChange:canvas.renderAll.bind(canvas),duration:1e3,easing:fabric.util.ease.easeInOutQuad,onComplete:n})}),e.animate("flipY",!e.flipY,{onChange:canvas.renderAll.bind(canvas),duration:1e3,easing:fabric.util.ease.easeInOutQuad,onComplete:()=>e.animate("flipY",!e.flipY,{onChange:canvas.renderAll.bind(canvas),duration:1e3,easing:fabric.util.ease.easeInOutQuad})})}()}function animateShake(e){!function n(){const a=[5,-5,5,-5,0];!function t(i){e.animate("left",e.left+a[i],{onChange:canvas.renderAll.bind(canvas),duration:100,easing:fabric.util.ease.easeInOutQuad,onComplete:()=>{i<a.length-1?t(i+1):n()}})}(0)}()}function startRecording(){const e=canvas.getElement().captureStream(30);mediaRecorder=new MediaRecorder(e,{mimeType:"video/webm; codecs=vp9"}),mediaRecorder.ondataavailable=function(e){e.data.size>0&&recordedChunks.push(e.data)},mediaRecorder.onstop=function(){const e=new Blob(recordedChunks,{type:"video/webm"}),n=URL.createObjectURL(e),a=document.createElement("a");a.style.display="none",a.href=n,a.download="animation.webm",document.body.appendChild(a),a.click(),setTimeout((()=>{document.body.removeChild(a),URL.revokeObjectURL(n)}),100)},mediaRecorder.start()}function stopRecording(){mediaRecorder.stop()}canvas.on("drop",(function(e){e.e.preventDefault();const n=e.e.dataTransfer.files[0],a=new FileReader;a.onload=function(e){const n=e.target.result;fabric.Image.fromURL(n,(function(e){const n=Math.min(canvas.width/e.width,canvas.height/e.height);e.scale(n),e.set({left:canvas.width/2-e.width*n/2,top:canvas.height/2-e.height*n/2}),canvas.add(e),img=e}))},a.readAsDataURL(n)})),canvas.on("dragover",(function(e){e.e.preventDefault()})),document.getElementById("rotateButton").addEventListener("click",(function(){img&&animateRotation(img)})),document.getElementById("moveButton").addEventListener("click",(function(){img&&animateMovement(img)})),document.getElementById("bounceButton").addEventListener("click",(function(){img&&animateBounce(img)})),document.getElementById("scaleButton").addEventListener("click",(function(){img&&animateScale(img)})),document.getElementById("heartbeatButton").addEventListener("click",(function(){img&&animateHeartbeat(img)})),document.getElementById("fadeButton").addEventListener("click",(function(){img&&animateFade(img)})),document.getElementById("flipButton").addEventListener("click",(function(){img&&animateFlip(img)})),document.getElementById("shakeButton").addEventListener("click",(function(){img&&animateShake(img)})),document.getElementById("startRecordingButton").addEventListener("click",startRecording),document.getElementById("stopRecordingButton").addEventListener("click",stopRecording)</script></body></html>